<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cadastro de Credenciais</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <div class="header-brand">
                <div class="brand-container">
                    <img src="AI.png" alt="Atendimento Inteligente" class="brand-logo">
                </div>
            </div>
            
            <div class="header-navigation">
                <div class="nav-tabs">
                    <button id="btnCredenciais" class="nav-tab active">
                        <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
                        </svg>
                        <span>Credenciais</span>
                    </button>
                    <button id="btnSenhasTotem" class="nav-tab">
                        <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                        <span>Senhas do Totem</span>
                    </button>
                </div>
            </div>
            
            <div class="header-content">
                <div class="page-info">
                    <h2 id="headerTitle">Cadastro de Credenciais</h2>
                    <p id="headerSubtitle">Gerencie credenciais de funcion√°rios e senhas do totem</p>
                </div>
                <div class="header-actions">
                    <button id="btnNovoCadastro" class="btn btn-primary">
                        <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/>
                            <circle cx="9" cy="7" r="4"/>
                            <line x1="19" y1="8" x2="19" y2="14"/>
                            <line x1="22" y1="11" x2="16" y2="11"/>
                        </svg>
                        <span>Novo Cadastro</span>
                    </button>
                    <button id="btnVerTotem" class="btn btn-info" style="display: none;">
                        <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="2" y="3" width="20" height="14" rx="2" ry="2"/>
                            <line x1="8" y1="21" x2="16" y2="21"/>
                            <line x1="12" y1="17" x2="12" y2="21"/>
                        </svg>
                        <span>Ver Totem</span>
                    </button>
                    <button id="btnEnviarEmail" class="btn btn-success">
                        <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
                            <polyline points="22,6 12,13 2,6"/>
                        </svg>
                        <span>Enviar por Email</span>
                    </button>
                </div>
            </div>
        </header>

        <main>
            <!-- Se√ß√£o Cadastro de Credenciais -->
            <div id="secaoCredenciais" class="secao-conteudo active">
                <div class="lista-container">
                    <div class="search-bar">
                        <input type="text" id="searchInput" placeholder="Buscar por nome ou tipo...">
                    </div>
                    
                    <div class="table-container">
                        <table id="tabelaCredenciais">
                            <thead>
                                <tr>
                                    <th>Nome</th>
                                    <th>Tipo</th>
                                    <th>Unidade</th>
                                    <th>Especialidade</th>
                                    <th>A√ß√µes</th>
                                </tr>
                            </thead>
                            <tbody id="corpoTabela">
                                <!-- Dados ser√£o inseridos aqui dinamicamente -->
                            </tbody>
                        </table>
                    </div>
                    
                    <div id="mensagemVazia" class="mensagem-vazia">
                        <p>Nenhum cadastro encontrado. Clique em "Novo Cadastro" para come√ßar.</p>
                    </div>
                </div>
            </div>

            <!-- Se√ß√£o Senhas do Totem -->
            <div id="secaoSenhasTotem" class="secao-conteudo">
                <div class="lista-container">
                    <div id="unidadeAtualContainer" class="unidade-atual-container" style="display: none;">
                        <div class="unidade-atual">
                            <strong>Unidade:</strong> <span id="unidadeAtualTexto"></span>
                            <button type="button" class="btn btn-sm btn-secondary" id="btnAlterarUnidade">Alterar</button>
                        </div>
                    </div>
                    
                    <div class="search-bar">
                        <input type="text" id="searchInputTotem" placeholder="Buscar senhas do totem...">
                    </div>
                    
                    <div class="table-container">
                        <table id="tabelaSenhasTotem">
                            <thead>
                                <tr>
                                    <th>Ordem</th>
                                    <th>Nome da Senha</th>
                                    <th>Cor</th>
                                    <th>Pr√©-visualiza√ß√£o</th>
                                    <th>Data Cria√ß√£o</th>
                                    <th>A√ß√µes</th>
                                </tr>
                            </thead>
                            <tbody id="corpoTabelaTotem">
                                <!-- Dados ser√£o inseridos aqui dinamicamente -->
                            </tbody>
                        </table>
                    </div>
                    
                    <div id="mensagemVaziaTotem" class="mensagem-vazia">
                        <p>Nenhuma senha cadastrada. Clique em "Nova Senha" para come√ßar.</p>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Modal de Cadastro -->
    <div id="modalCadastro" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitulo">Novo Cadastro</h2>
                <span class="close">&times;</span>
            </div>
            
            <form id="formCadastro">
                <!-- Unidade Atual (aparece quando j√° definida) -->
                <div id="unidadeAtualCredenciais" class="unidade-atual-container" style="display: none;">
                    <div class="unidade-atual">
                        <div>
                            <strong>Unidade:</strong>
                            <span id="unidadeAtualTextoCredenciais"></span>
                        </div>
                        <button type="button" class="btn btn-sm btn-secondary" onclick="sistema.permitirAlterarUnidadeCredenciais()">
                            Alterar
                        </button>
                    </div>
                </div>

                <!-- Campo de Empresa (aparece quando n√£o definida) -->
                <div id="campoEmpresaCredenciais" class="form-group">
                    <label for="empresaCredenciais">Empresa *</label>
                    <input type="text" id="empresaCredenciais" name="empresaCredenciais" placeholder="Ex: Intelite Tecnologia" required>
                    <small>Nome da empresa/organiza√ß√£o</small>
                </div>

                <!-- Campo de Unidade (aparece quando n√£o definida) -->
                <div id="campoUnidadeCredenciais" class="form-group">
                    <label for="unidadeCredenciais">Unidade *</label>
                    <input type="text" id="unidadeCredenciais" name="unidadeCredenciais" placeholder="Ex: Jo√£o Pessoa, Campina Grande" required>
                    <small>Nome da unidade/filial espec√≠fica</small>
                </div>

                <div class="form-group">
                    <label for="tipo">Tipo *</label>
                    <select id="tipo" name="tipo" required>
                        <option value="">Selecione o tipo</option>
                        <option value="recepcao">Recep√ß√£o M√©dica</option>
                        <option value="recepcao-odonto">Recep√ß√£o Odonto</option>
                        <option value="medicina">Medicina</option>
                        <option value="odonto">Odontologia</option>
                        <option value="laboratorio">Laborat√≥rio</option>
                        <option value="pos-consulta">P√≥s Consulta</option>
                        <option value="novo-tipo" style="color: #007bff; font-weight: bold;">+ Novo Tipo</option>
                    </select>
                </div>

                <!-- Campo para Novo Tipo Personalizado -->
                <div id="campoNovoTipo" class="form-group" style="display: none;">
                    <label for="novoTipoNome">Nome do Novo Tipo *</label>
                    <input type="text" id="novoTipoNome" name="novoTipoNome" placeholder="Ex: Fisioterapia, Nutri√ß√£o, etc...">
                    <small>Digite o nome do novo tipo que ser√° salvo para uso futuro</small>
                </div>



                <!-- Campos espec√≠ficos para Recep√ß√£o -->
                <div id="camposRecepcao" class="campos-especificos" style="display: none;">
                    <div class="form-group">
                        <label>Funcion√°rios</label>
                        <div class="funcionarios-container">
                            <table class="profissionais-table">
                                <thead>
                                    <tr>
                                        <th>Nome</th>
                                        <th>Senhas que ir√° chamar</th>
                                    </tr>
                                </thead>
                                <tbody id="funcionariosTableBody">
                                    <!-- As linhas ser√£o geradas dinamicamente -->
                                </tbody>
                            </table>
                            <button type="button" id="btnMaisLinhasFuncionarios" class="btn btn-secondary btn-sm" style="margin-top: 10px;">
                                <span>+ 1 linha</span>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Campos espec√≠ficos para Medicina/Odontologia -->
                <div id="camposMedOdonto" class="campos-especificos" style="display: none;">
                    <div class="form-group">
                        <label>Profissionais</label>
                        <div class="profissionais-container">
                            <table class="profissionais-table">
                                <thead>
                                    <tr>
                                        <th>Tratamento</th>
                                        <th>Nome</th>
                                        <th>Especialidade</th>
                                    </tr>
                                </thead>
                                <tbody id="profissionaisTableBody">
                                    <!-- As linhas ser√£o geradas dinamicamente -->
                                </tbody>
                            </table>
                            <button type="button" id="btnMaisLinhas" class="btn btn-secondary btn-sm" style="margin-top: 10px;">
                                <span>+ 1 linha</span>
                            </button>
                        </div>
                    </div>
                </div>



                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" id="btnCancelar">Cancelar</button>
                    <button type="submit" class="btn btn-primary" id="btnSalvar">Salvar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal de Senha do Totem -->
    <div id="modalSenhaTotem" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTituloTotem">Nova Senha do Totem</h2>
                <span class="close">&times;</span>
            </div>
            
            <form id="formSenhaTotem">
                <div class="form-group">
                    <label for="empresaTotem">Empresa *</label>
                    <input type="text" id="empresaTotem" name="empresaTotem" placeholder="Ex: Intelite Tecnologia" required>
                    <small>Nome da empresa/organiza√ß√£o</small>
                </div>
                
                <div class="form-group">
                    <label for="unidadeTotem">Unidade *</label>
                    <input type="text" id="unidadeTotem" name="unidadeTotem" placeholder="Ex: Jo√£o Pessoa, Campina Grande" required>
                    <small>Nome da unidade/filial espec√≠fica</small>
                </div>
                
                <div class="form-group">
                    <label for="nomeSenhaTotem">Nome da Senha *</label>
                    <input type="text" id="nomeSenhaTotem" name="nomeSenhaTotem" placeholder="Ex: MEDICINA GERAL, CARDIOLOGIA, PEDIATRIA..." required>
                    <small>Digite o nome da senha que aparecer√° no totem</small>
                </div>
                
                <div class="form-group">
                    <label for="ordemTotem">Ordem no Totem *</label>
                    <select id="ordemTotem" name="ordemTotem" required>
                        <option value="">Selecione a posi√ß√£o</option>
                        <!-- Op√ß√µes ser√£o inseridas dinamicamente -->
                    </select>
                    <small>Escolha em qual posi√ß√£o esta senha aparecer√° no totem</small>
                </div>
                
                <div class="form-group">
                    <label for="corFundoTotem">Cor de Fundo *</label>
                    <div class="color-input-container">
                        <input type="color" id="corFundoTotem" name="corFundoTotem" value="#667eea" required>
                        <input type="text" id="corFundoTextoTotem" name="corFundoTextoTotem" value="#667eea" placeholder="#667eea" maxlength="7" required>
                    </div>
                    <small>Escolha a cor de fundo que a senha ter√° no totem</small>
                </div>
                
                <div class="form-group">
                    <label>Pr√©-visualiza√ß√£o da Senha</label>
                    <div id="previewSenhaTotem" class="preview-senha">
                        <span id="previewTextoTotem">NOME DA SENHA</span>
                    </div>
                </div>

                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" id="btnCancelarTotem">Cancelar</button>
                    <button type="submit" class="btn btn-primary" id="btnSalvarTotem">Salvar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal do Totem -->
    <div id="modalTotem" class="modal modal-totem">
        <div class="modal-content modal-totem-content">
            <div class="totem-container">
                <!-- Background fixo do totem -->
                <div class="totem-background">
                    <!-- Esta div ter√° o background da imagem -->
                </div>
                
                <!-- Bot√£o de fechar sobre o totem -->
                <div class="totem-close-btn">
                    <span class="close">&times;</span>
                </div>
                
                <!-- Overlay para as senhas din√¢micas -->
                <div class="totem-overlay">
                    <div class="totem-options-dynamic" id="totemOptions">
                        <!-- Senhas ser√£o inseridas aqui dinamicamente sobre o background -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Confirma√ß√£o -->
    <div id="modalConfirmacao" class="modal">
        <div class="modal-content modal-small">
            <div class="modal-header">
                <h3>Confirmar Exclus√£o</h3>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <p>Tem certeza que deseja excluir este cadastro?</p>
                <p><strong id="nomeExclusao"></strong></p>
            </div>
            <div class="form-actions">
                <button type="button" class="btn btn-secondary" id="btnCancelarExclusao">Cancelar</button>
                <button type="button" class="btn btn-danger" id="btnConfirmarExclusao">Excluir</button>
            </div>
        </div>
    </div>

    <!-- Modal de Envio por Email -->
    <div id="modalEmail" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Enviar por Email</h2>
                <span class="close">&times;</span>
            </div>
            
            <form id="formEmail" action="https://formsubmit.co/suporte.intelite@gmail.com" method="POST" enctype="multipart/form-data">
                <!-- Campos ocultos do FormSubmit -->
                <input type="hidden" name="_next" value="https://formsubmit.co/thankyou">
                <input type="hidden" name="_captcha" value="false">
                <input type="hidden" name="_template" value="table">
                <input type="hidden" name="_autoresponse" value="Obrigado! Recebemos suas planilhas de credenciais e entraremos em contato em breve.">
                
                <div class="modal-body">
                    <div class="form-group">
                        <label for="emailDestino">Email de Destino</label>
                        <input type="email" id="emailDestino" name="emailDestino" 
                               value="suporte.intelite@gmail.com" readonly>
                        <small>Email padr√£o do destinat√°rio</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="emailRemetente">Seu Email *</label>
                        <input type="email" id="emailRemetente" name="email" 
                               placeholder="Digite seu email" required>
                        <small>Digite seu email para receber confirma√ß√£o</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="nomeRemetente">Seu Nome *</label>
                        <input type="text" id="nomeRemetente" name="nome" 
                               placeholder="Digite seu nome" required>
                        <small>Digite seu nome para identifica√ß√£o</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="assuntoEmail">Assunto</label>
                        <input type="text" id="assuntoEmail" name="_subject" readonly>
                    </div>
                    
                    <div class="form-group">
                        <label for="corpoEmail">Mensagem</label>
                        <textarea id="corpoEmail" name="mensagem" rows="8" readonly></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label>Arquivos em Anexo</label>
                        <div id="listaAnexos" class="lista-anexos">
                            <!-- Lista de anexos ser√° gerada dinamicamente -->
                        </div>
                        <!-- Campos de arquivo ocultos ser√£o inseridos aqui -->
                        <div id="camposArquivos" style="display: none;"></div>
                    </div>
                    
                    <div class="info-fields">
                        <div class="form-group">
                            <label for="empresaInfo">Informa√ß√µes da Empresa</label>
                            <input type="text" id="empresaInfo" name="empresa" readonly>
                        </div>
                        
                        <div class="form-group">
                            <label for="unidadeInfo">Informa√ß√µes da Unidade</label>
                            <input type="text" id="unidadeInfo" name="unidade" readonly>
                        </div>
                        
                        <div class="form-group">
                            <label for="totalCredenciais">Total de Registros</label>
                            <input type="text" id="totalCredenciais" name="total_registros" readonly>
                        </div>
                    </div>
                </div>
                
                <div class="form-actions">
                    <button type="button" id="btnCancelarEmail" class="btn btn-secondary">Cancelar</button>
                    <button type="submit" id="btnEnviarEmailModal" class="btn btn-primary">
                        <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
                            <polyline points="22,6 12,13 2,6"></polyline>
                        </svg>
                        Enviar Email
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal de Instru√ß√µes FormSubmit -->
    <div id="modalInstrucoes" class="modal">
        <div class="modal-content modal-small">
            <div class="modal-header">
                <h3>üìß Como Enviar Emails</h3>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <div style="text-align: center; margin-bottom: 20px;">
                    <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="color: #4f46e5;">
                        <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
                        <polyline points="22,6 12,13 2,6"></polyline>
                    </svg>
                </div>
                
                <div style="background: #e0f2fe; padding: 15px; border-radius: 8px; border-left: 4px solid #0288d1; margin-bottom: 20px;">
                    <h4 style="margin: 0 0 10px 0; color: #01579b;">üöÄ Para Envio Autom√°tico (Recomendado)</h4>
                    <p style="margin: 0; font-size: 0.9em;">
                        Use um servidor local: <br>
                        <code style="background: #fff; padding: 2px 6px; border-radius: 4px;">python -m http.server 8000</code><br>
                        Depois acesse: <strong>http://localhost:8000</strong>
                    </p>
                </div>
                
                <div style="background: #fff3e0; padding: 15px; border-radius: 8px; border-left: 4px solid #f57c00; margin-bottom: 15px;">
                    <h4 style="margin: 0 0 10px 0; color: #e65100;">üìé Usando Arquivo Local</h4>
                    <ul style="margin: 10px 0; padding-left: 20px; font-size: 0.9em;">
                        <li>Sistema detecta automaticamente</li>
                        <li>Baixa arquivos automaticamente</li>
                        <li>Abre cliente de email com dados preenchidos</li>
                        <li><strong>Voc√™ anexa</strong> os arquivos baixados</li>
                    </ul>
                </div>
                
                <div style="background: #f0f9ff; padding: 15px; border-radius: 8px; border-left: 4px solid #0ea5e9; margin: 15px 0;">
                    <p style="margin: 0; font-size: 0.9em; color: #0c4a6e;">
                        <strong>üí° Dica:</strong> Para melhor experi√™ncia, recomendamos usar o servidor local para envio autom√°tico com anexos.
                    </p>
                </div>
            </div>
            <div class="form-actions">
                <button type="button" class="btn btn-primary" id="btnEntendido">Entendi!</button>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="script.js"></script>
</body>
</html> 