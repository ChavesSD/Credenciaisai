<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="theme-color" content="#0066cc">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="favicon.png">
    <link rel="shortcut icon" type="image/png" href="favicon.png">
    <link rel="apple-touch-icon" sizes="180x180" href="favicon.png">
    <meta name="msapplication-TileColor" content="#0066cc">
    <meta name="msapplication-TileImage" content="favicon.png">
    
    <title>Cadastro de Credenciais</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>


    <div class="container">
        <header>
            <div class="header-brand">
                <div class="brand-container">
                    <img src="AI.png" alt="Atendimento Inteligente" class="brand-logo">
                </div>
            </div>
            
            <div class="header-navigation">
                <div class="nav-tabs">
                    <button id="btnCredenciais" class="nav-tab active">
                        <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
                        </svg>
                        <span>Credenciais</span>
                    </button>
                    <button id="btnSenhasTotem" class="nav-tab">
                        <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                        <span>Senhas do Totem</span>
                    </button>
                </div>
            </div>
            
            <div class="header-content">
                <div class="page-info">
                    <h2 id="headerTitle">Cadastro de Credenciais</h2>
                    <p id="headerSubtitle">Gerencie credenciais de funcion√°rios e senhas do totem</p>
                </div>
                <div class="header-actions">
                    <button id="btnNovoCadastro" class="btn btn-primary" style="display: none;">
                        <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/>
                            <circle cx="9" cy="7" r="4"/>
                            <line x1="19" y1="8" x2="19" y2="14"/>
                            <line x1="22" y1="11" x2="16" y2="11"/>
                        </svg>
                        <span>Novo Cadastro</span>
                    </button>
                    <button id="btnVerTotem" class="btn btn-info" style="display: none;">
                        <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="2" y="3" width="20" height="14" rx="2" ry="2"/>
                            <line x1="8" y1="21" x2="16" y2="21"/>
                            <line x1="12" y1="17" x2="12" y2="21"/>
                        </svg>
                        <span>Ver Totem</span>
                    </button>
                    <button id="btnExportarExcel" class="btn btn-accent">
                        <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                            <polyline points="7,10 12,15 17,10"/>
                            <line x1="12" y1="15" x2="12" y2="3"/>
                        </svg>
                        <span>Exportar Excel</span>
                    </button>
                    <button id="btnEnviarEmail" class="btn btn-success">
                        <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
                            <polyline points="22,6 12,13 2,6"/>
                        </svg>
                        <span>Enviar por Email</span>
                    </button>
                </div>
            </div>
        </header>

        <main>
            <!-- Se√ß√£o Cadastro de Credenciais -->
            <div id="secaoCredenciais" class="secao-conteudo active">
                <div class="lista-container">
                    <!-- Nome da Empresa Atual (aparece quando j√° definida) -->
                    <div id="unidadeAtualCredenciaisInline" class="unidade-atual-container" style="display: none;">
                        <div class="unidade-atual">
                            <div>
                                <strong>Empresa:</strong>
                                <span id="unidadeAtualTextoCredenciaisInline"></span>
                            </div>
                            <button type="button" class="btn btn-sm btn-secondary" onclick="sistema.permitirAlterarUnidadeCredenciaisInline()">
                                Alterar
                            </button>
                        </div>
                    </div>
                    
                    <div class="search-bar">
                        <input type="text" id="searchInput" placeholder="Buscar por nome ou tipo...">
                    </div>
                    
                    <!-- Formul√°rio Inline de Cadastro -->
                    <div id="formularioInlineCredenciais" class="formulario-inline">
                        <form id="formCadastroInline">
                            <!-- Campo de Nome da Empresa (aparece quando n√£o definida) -->
                            <div id="campoUnidadeCredenciaisInline" class="form-group-inline full-width">
                                <label for="unidadeCredenciaisInline">Nome da Empresa *</label>
                                <input type="text" id="unidadeCredenciaisInline" name="unidadeCredenciais" placeholder="Ex: Cl√≠nica S√£o Paulo, Hospital Central" required>
                                <small>Nome da empresa ou institui√ß√£o</small>
                            </div>

                            <div class="form-group-inline">
                                <label for="tipoInline">Tipo de Usu√°rio *</label>
                                <select id="tipoInline" name="tipo" required>
                                    <option value="">Selecione o tipo de usu√°rio</option>
                                    <option value="recepcao">Recep√ß√£o M√©dica</option>
                                    <option value="recepcao-odonto">Recep√ß√£o Odonto</option>
                                    <option value="medicina">Medicina</option>
                                    <option value="odonto">Odontologia</option>
                                    <option value="laboratorio">Laborat√≥rio</option>
                                    <option value="pos-consulta">P√≥s Consulta</option>
                                    <option value="novo-tipo" style="color: #007bff; font-weight: bold;">+ Novo Tipo</option>
                                </select>
                            </div>

                            <!-- Campo para Novo Tipo Personalizado -->
                            <div id="campoNovoTipoInline" class="form-group-inline full-width" style="display: none;">
                                <label for="novoTipoNomeInline">Nome do Novo Tipo *</label>
                                <input type="text" id="novoTipoNomeInline" name="novoTipoNome" placeholder="Ex: Fisioterapia, Nutri√ß√£o, etc...">
                                <small>Digite o nome do novo tipo que ser√° salvo para uso futuro</small>
                            </div>

                            <!-- Campos espec√≠ficos para Recep√ß√£o -->
                            <div id="camposRecepcaoInline" class="campos-especificos-inline" style="display: none;">
                                <div class="form-group-inline">
                                    <label>Funcion√°rios</label>
                                    <div class="funcionarios-container">
                                        <table class="profissionais-table">
                                            <thead>
                                                <tr>
                                                    <th>Nome e Sobrenome</th>
                                                    <th>Senhas que ir√° chamar</th>
                                                </tr>
                                            </thead>
                                            <tbody id="funcionariosTableBodyInline">
                                                <!-- As linhas ser√£o geradas dinamicamente -->
                                            </tbody>
                                        </table>
                                        <button type="button" id="btnMaisLinhasFuncionariosInline" class="btn btn-secondary btn-sm" style="margin-top: 10px;">
                                            <span>+ 1 linha</span>
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- Campos espec√≠ficos para Medicina/Odontologia -->
                            <div id="camposMedOdontoInline" class="campos-especificos-inline" style="display: none;">
                                <div class="form-group-inline">
                                    <label>Profissionais</label>
                                    <div class="profissionais-container">
                                        <table class="profissionais-table">
                                            <thead>
                                                <tr>
                                                    <th>Tratamento</th>
                                                    <th>Nome e Sobrenome</th>
                                                    <th>Especialidade</th>
                                                </tr>
                                            </thead>
                                            <tbody id="profissionaisTableBodyInline">
                                                <!-- As linhas ser√£o geradas dinamicamente -->
                                            </tbody>
                                        </table>
                                        <button type="button" id="btnMaisLinhasInline" class="btn btn-secondary btn-sm" style="margin-top: 10px;">
                                            <span>+ 1 linha</span>
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <div class="form-actions-inline">
                                <button type="button" class="btn btn-secondary btn-sm" id="btnLimparCredenciais">Limpar</button>
                                <button type="submit" class="btn btn-primary btn-sm" id="btnSalvarCredenciais">Salvar</button>
                            </div>
                        </form>
                    </div>
                    
                    <div class="table-container">
                        <table id="tabelaCredenciais">
                            <thead>
                                <tr>
                                    <th>Nome e Sobrenome</th>
                                    <th>Tipo</th>
                                    <th>Unidade</th>
                                    <th>Especialidade</th>
                                    <th>A√ß√µes</th>
                                </tr>
                            </thead>
                            <tbody id="corpoTabela">
                                <!-- Dados ser√£o inseridos aqui dinamicamente -->
                            </tbody>
                        </table>
                    </div>
                    
                    <div id="mensagemVazia" class="mensagem-vazia">
                        <p>Nenhum cadastro encontrado. Use o formul√°rio acima para adicionar novos cadastros.</p>
                    </div>
                </div>
            </div>

            <!-- Se√ß√£o Senhas do Totem -->
            <div id="secaoSenhasTotem" class="secao-conteudo">
                <div class="lista-container">
                    <div id="unidadeAtualContainer" class="unidade-atual-container" style="display: none;">
                        <div class="unidade-atual">
                            <strong>Empresa:</strong> <span id="unidadeAtualTexto"></span>
                            <button type="button" class="btn btn-sm btn-secondary" id="btnAlterarUnidade">Alterar</button>
                        </div>
                    </div>
                    
                    <div class="search-bar">
                        <input type="text" id="searchInputTotem" placeholder="Buscar senhas do totem...">
                    </div>
                    
                    <!-- Formul√°rio Inline de Senha do Totem -->
                    <div id="formularioInlineTotem" class="formulario-inline">
                        <form id="formSenhaTotemInline">
                            <div class="form-group-inline full-width">
                                <label for="unidadeTotemInline">Nome da Empresa *</label>
                                <input type="text" id="unidadeTotemInline" name="unidadeTotem" placeholder="Ex: Cl√≠nica S√£o Paulo, Hospital Central" required>
                                <small>Nome da empresa ou institui√ß√£o</small>
                            </div>
                            
                            <div class="form-group-inline full-width">
                                <label for="nomeSenhaTotemInline">Nome da Senha *</label>
                                <input type="text" id="nomeSenhaTotemInline" name="nomeSenhaTotem" placeholder="Ex: MEDICINA GERAL, CARDIOLOGIA, PEDIATRIA..." required>
                                <small>Digite o nome da senha que aparecer√° no totem</small>
                            </div>
                            
                            <!-- Exibir no Totem (switch) -->
                            <div class="form-group-inline" id="grupoExibirTotemInline">
                                <label for="exibirNoTotemInline">Exibir no Totem</label>
                                <div class="switch-row">
                                    <label class="switch">
                                        <input type="checkbox" id="exibirNoTotemInline" name="exibirNoTotem" checked>
                                        <span class="slider"></span>
                                    </label>
                                    <small style="margin-left: 10px;">Ative para mostrar essa senha no totem</small>
                                </div>
                            </div>

                            <div class="form-group-inline">
                                <label for="ordemTotemInline">Ordem no Totem *</label>
                                <select id="ordemTotemInline" name="ordemTotem" required>
                                    <option value="">Selecione a posi√ß√£o</option>
                                    <!-- Op√ß√µes ser√£o inseridas dinamicamente -->
                                </select>
                                <small>Escolha em qual posi√ß√£o esta senha aparecer√° no totem</small>
                            </div>
                            
                            <div class="form-group-inline">
                                <label for="corFundoTotemInline">Cor de Fundo *</label>
                                <div class="color-input-container">
                                    <input type="color" id="corFundoTotemInline" name="corFundoTotem" value="#0066cc" required>
                                    <input type="text" id="corFundoTextoTotemInline" name="corFundoTextoTotem" value="#0066cc" placeholder="#0066cc" maxlength="7" required>
                                </div>
                                <small>Escolha a cor de fundo que a senha ter√° no totem</small>
                            </div>
                            
                            <div class="form-group-inline full-width">
                                <label>Pr√©-visualiza√ß√£o da Senha</label>
                                <div id="previewSenhaTotemInline" class="preview-senha">
                                    <span id="previewTextoTotemInline">NOME DA SENHA</span>
                                </div>
                            </div>

                            <div class="form-actions-inline">
                                <button type="button" class="btn btn-secondary btn-sm" id="btnLimparTotem">Limpar</button>
                                <button type="submit" class="btn btn-primary btn-sm" id="btnSalvarTotemInline">Salvar</button>
                            </div>
                        </form>
                    </div>
                    
                    <div class="table-container">
                        <table id="tabelaSenhasTotem">
                            <thead>
                                <tr>
                                    <th>Ordem</th>
                                    <th>Nome da Senha</th>
                                    <th>Cor</th>
                                    <th>Pr√©-visualiza√ß√£o</th>
                                    <th>Exibir no Totem</th>
                                    <th>Data Cria√ß√£o</th>
                                    <th>A√ß√µes</th>
                                </tr>
                            </thead>
                            <tbody id="corpoTabelaTotem">
                                <!-- Dados ser√£o inseridos aqui dinamicamente -->
                            </tbody>
                        </table>
                    </div>
                    
                    <div id="mensagemVaziaTotem" class="mensagem-vazia">
                        <p>Nenhuma senha cadastrada. Use o formul√°rio acima para adicionar novas senhas.</p>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Modal de Cadastro -->
    <div id="modalCadastro" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitulo">Novo Cadastro</h2>
                <span class="close">&times;</span>
            </div>
            
            <form id="formCadastro">
                <!-- Nome da Empresa Atual (aparece quando j√° definida) -->
                <div id="unidadeAtualCredenciais" class="unidade-atual-container" style="display: none;">
                    <div class="unidade-atual">
                        <div>
                            <strong>Empresa:</strong>
                            <span id="unidadeAtualTextoCredenciais"></span>
                        </div>
                        <button type="button" class="btn btn-sm btn-secondary" onclick="sistema.permitirAlterarUnidadeCredenciais()">
                            Alterar
                        </button>
                    </div>
                </div>



                <!-- Campo de Nome da Empresa (aparece quando n√£o definida) -->
                <div id="campoUnidadeCredenciais" class="form-group">
                    <label for="unidadeCredenciais">Nome da Empresa *</label>
                    <input type="text" id="unidadeCredenciais" name="unidadeCredenciais" placeholder="Ex: Cl√≠nica S√£o Paulo, Hospital Central" required>
                    <small>Nome da empresa ou institui√ß√£o</small>
                </div>

                <div class="form-group">
                    <label for="tipo">Tipo de Usu√°rio *</label>
                    <select id="tipo" name="tipo" required>
                        <option value="">Selecione o tipo de usu√°rio</option>
                        <option value="recepcao">Recep√ß√£o M√©dica</option>
                        <option value="recepcao-odonto">Recep√ß√£o Odonto</option>
                        <option value="medicina">Medicina</option>
                        <option value="odonto">Odontologia</option>
                        <option value="laboratorio">Laborat√≥rio</option>
                        <option value="pos-consulta">P√≥s Consulta</option>
                        <option value="novo-tipo" style="color: #007bff; font-weight: bold;">+ Novo Tipo</option>
                    </select>
                </div>

                <!-- Campo para Novo Tipo Personalizado -->
                <div id="campoNovoTipo" class="form-group" style="display: none;">
                    <label for="novoTipoNome">Nome do Novo Tipo *</label>
                    <input type="text" id="novoTipoNome" name="novoTipoNome" placeholder="Ex: Fisioterapia, Nutri√ß√£o, etc...">
                    <small>Digite o nome do novo tipo que ser√° salvo para uso futuro</small>
                </div>



                <!-- Campos espec√≠ficos para Recep√ß√£o -->
                <div id="camposRecepcao" class="campos-especificos" style="display: none;">
                    <div class="form-group">
                        <label>Funcion√°rios</label>
                        <div class="funcionarios-container">
                            <table class="profissionais-table">
                                <thead>
                                    <tr>
                                        <th>Nome e Sobrenome</th>
                                        <th>Senhas que ir√° chamar</th>
                                    </tr>
                                </thead>
                                <tbody id="funcionariosTableBody">
                                    <!-- As linhas ser√£o geradas dinamicamente -->
                                </tbody>
                            </table>
                            <button type="button" id="btnMaisLinhasFuncionarios" class="btn btn-secondary btn-sm" style="margin-top: 10px;">
                                <span>+ 1 linha</span>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Campos espec√≠ficos para Medicina/Odontologia -->
                <div id="camposMedOdonto" class="campos-especificos" style="display: none;">
                    <div class="form-group">
                        <label>Profissionais</label>
                        <div class="profissionais-container">
                            <table class="profissionais-table">
                                <thead>
                                    <tr>
                                        <th>Tratamento</th>
                                        <th>Nome e Sobrenome</th>
                                        <th>Especialidade</th>
                                    </tr>
                                </thead>
                                <tbody id="profissionaisTableBody">
                                    <!-- As linhas ser√£o geradas dinamicamente -->
                                </tbody>
                            </table>
                            <button type="button" id="btnMaisLinhas" class="btn btn-secondary btn-sm" style="margin-top: 10px;">
                                <span>+ 1 linha</span>
                            </button>
                        </div>
                    </div>
                </div>



                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" id="btnCancelar">Cancelar</button>
                    <button type="submit" class="btn btn-primary" id="btnSalvar">Salvar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal de Senha do Totem -->
    <div id="modalSenhaTotem" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTituloTotem">Nova Senha do Totem</h2>
                <span class="close">&times;</span>
            </div>
            
            <form id="formSenhaTotem">
                <div class="form-group">
                    <label for="unidadeTotem">Nome da Empresa *</label>
                    <input type="text" id="unidadeTotem" name="unidadeTotem" placeholder="Ex: Cl√≠nica S√£o Paulo, Hospital Central" required>
                    <small>Nome da empresa ou institui√ß√£o</small>
                </div>
                
                <div class="form-group">
                    <label for="nomeSenhaTotem">Nome da Senha *</label>
                    <input type="text" id="nomeSenhaTotem" name="nomeSenhaTotem" placeholder="Ex: MEDICINA GERAL, CARDIOLOGIA, PEDIATRIA..." required>
                    <small>Digite o nome da senha que aparecer√° no totem</small>
                </div>
                
                <!-- Exibir no Totem (switch) -->
                <div class="form-group" id="grupoExibirTotem">
                    <label for="exibirNoTotem">Exibir no Totem</label>
                    <div class="switch-row">
                        <label class="switch">
                            <input type="checkbox" id="exibirNoTotem" name="exibirNoTotem" checked>
                            <span class="slider"></span>
                        </label>
                        <small style="margin-left: 10px;">Ative para mostrar essa senha no totem</small>
                    </div>
                </div>

                <div class="form-group">
                    <label for="ordemTotem">Ordem no Totem *</label>
                    <select id="ordemTotem" name="ordemTotem" required>
                        <option value="">Selecione a posi√ß√£o</option>
                        <!-- Op√ß√µes ser√£o inseridas dinamicamente -->
                    </select>
                    <small>Escolha em qual posi√ß√£o esta senha aparecer√° no totem</small>
                </div>
                
                <div class="form-group">
                    <label for="corFundoTotem">Cor de Fundo *</label>
                    <div class="color-input-container">
                        <input type="color" id="corFundoTotem" name="corFundoTotem" value="#0066cc" required>
                        <input type="text" id="corFundoTextoTotem" name="corFundoTextoTotem" value="#0066cc" placeholder="#0066cc" maxlength="7" required>
                    </div>
                    <small>Escolha a cor de fundo que a senha ter√° no totem</small>
                </div>
                
                <div class="form-group">
                    <label>Pr√©-visualiza√ß√£o da Senha</label>
                    <div id="previewSenhaTotem" class="preview-senha">
                        <span id="previewTextoTotem">NOME DA SENHA</span>
                    </div>
                </div>

                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" id="btnCancelarTotem">Cancelar</button>
                    <button type="submit" class="btn btn-primary" id="btnSalvarTotem">Salvar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal do Totem -->
    <div id="modalTotem" class="modal modal-totem">
        <div class="modal-content modal-totem-content">
            <div class="totem-container">
                <!-- Background fixo do totem -->
                <div class="totem-background">
                    <!-- Esta div ter√° o background da imagem -->
                </div>
                
                <!-- Bot√£o de fechar sobre o totem -->
                <div class="totem-close-btn">
                    <span class="close">&times;</span>
                </div>
                
                <!-- Overlay para as senhas din√¢micas -->
                <div class="totem-overlay">
                    <div class="totem-options-dynamic" id="totemOptions">
                        <!-- Senhas ser√£o inseridas aqui dinamicamente sobre o background -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Confirma√ß√£o -->
    <div id="modalConfirmacao" class="modal">
        <div class="modal-content modal-small">
            <div class="modal-header">
                <h3>Confirmar Exclus√£o</h3>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <p>Tem certeza que deseja excluir este cadastro?</p>
                <p><strong id="nomeExclusao"></strong></p>
            </div>
            <div class="form-actions">
                <button type="button" class="btn btn-secondary" id="btnCancelarExclusao">Cancelar</button>
                <button type="button" class="btn btn-danger" id="btnConfirmarExclusao">Excluir</button>
            </div>
        </div>
    </div>

    <!-- Modal de Envio por Email -->
    <div id="modalEmail" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Enviar por Email</h2>
                <span class="close">&times;</span>
            </div>
            
            <form id="formEmail">
                <div class="modal-body">
                    <div class="form-group">
                        <label for="emailDestino">Email de Destino</label>
                        <input type="email" id="emailDestino" name="emailDestino" 
                               value="suporte.intelite@gmail.com" readonly>
                        <small>Email padr√£o do destinat√°rio</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="emailRemetente">Seu Email *</label>
                        <input type="email" id="emailRemetente" name="email" 
                               placeholder="Digite seu email" required>
                        <small>Digite seu email para receber confirma√ß√£o</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="nomeRemetente">Seu Nome *</label>
                        <input type="text" id="nomeRemetente" name="nome" 
                               placeholder="Digite seu nome" required>
                        <small>Digite seu nome para identifica√ß√£o</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="assuntoEmail">Assunto</label>
                        <input type="text" id="assuntoEmail" name="_subject" readonly>
                    </div>
                    
                    <div class="form-group">
                        <label for="corpoEmail">Mensagem</label>
                        <textarea id="corpoEmail" name="mensagem" rows="8" readonly></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label>Arquivos em Anexo</label>
                        <div id="listaAnexos" class="lista-anexos">
                            <!-- Lista de anexos ser√° gerada dinamicamente -->
                        </div>
                        <!-- Campos de arquivo ocultos ser√£o inseridos aqui -->
                        <div id="camposArquivos" style="display: none;"></div>
                    </div>
                    
                    <div class="info-fields">
                        <div class="form-group">
                            <label for="totalCredenciais">Total de Registros</label>
                            <input type="text" id="totalCredenciais" name="total_registros" readonly>
                        </div>
                    </div>
                </div>
                
                <div class="form-actions">
                    <button type="button" id="btnCancelarEmail" class="btn btn-secondary">Cancelar</button>
                    <button type="submit" id="btnEnviarEmailModal" class="btn btn-primary">
                        <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
                            <polyline points="22,6 12,13 2,6"></polyline>
                        </svg>
                        Enviar Email
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal de Instru√ß√µes FormSubmit -->
    <div id="modalInstrucoes" class="modal">
        <div class="modal-content modal-small">
            <div class="modal-header">
                <h3>üìß Como Enviar Emails</h3>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <div style="text-align: center; margin-bottom: 20px;">
                    <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="color: #4f46e5;">
                        <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
                        <polyline points="22,6 12,13 2,6"></polyline>
                    </svg>
                </div>
                
                <div style="background: #e0f2fe; padding: 15px; border-radius: 8px; border-left: 4px solid #0288d1; margin-bottom: 20px;">
                    <h4 style="margin: 0 0 10px 0; color: #01579b;">üìß Envio via FormSubmit</h4>
                    <ul style="margin: 10px 0; padding-left: 20px; font-size: 0.9em;">
                        <li>‚úÖ Envio <strong>autom√°tico e direto</strong> da p√°gina</li>
                        <li>‚úÖ <strong>Arquivos Excel anexados automaticamente</strong></li>
                        <li>‚úÖ Funciona em qualquer ambiente (local ou servidor)</li>
                        <li>‚úÖ N√£o requer configura√ß√£o adicional</li>
                        <li>‚úÖ Email enviado para: <strong>suporte.intelite@gmail.com</strong></li>
                    </ul>
                </div>
                
                <div style="background: #f0f9ff; padding: 15px; border-radius: 8px; border-left: 4px solid #0ea5e9; margin: 15px 0;">
                    <p style="margin: 0; font-size: 0.9em; color: #0c4a6e;">
                        <strong>üí° Como funciona:</strong> Ap√≥s preencher seu nome e email, o sistema enviar√° automaticamente os arquivos Excel para o destinat√°rio. Voc√™ ser√° redirecionado para uma p√°gina de confirma√ß√£o.
                    </p>
                </div>
            </div>
            <div class="form-actions">
                <button type="button" class="btn btn-primary" id="btnEntendido">Entendi!</button>
            </div>
        </div>
    </div>

    <!-- Bot√£o Flutuante da Assistente Milly -->
    <button id="btnMillyAssistente" class="btn-milly-flutuante" title="Fale com a Milly, sua assistente virtual!">
        <img src="Milly_semfundo.png" alt="Assistente Milly" class="milly-flutuante-img">
    </button>

    <!-- Modal de Conversa√ß√£o com a Milly -->
    <div id="modalMillyChat" class="modal modal-milly-chat">
        <div class="modal-content modal-milly-chat-content">
            <div class="milly-chat-header">
                <div class="milly-chat-avatar">
                    <img src="Milly_semfundo.png" alt="Milly" class="milly-chat-img">
                    <div class="milly-status">
                        <span class="status-dot"></span>
                        <span>Milly est√° online</span>
                    </div>
                </div>
                <button id="btnFecharMillyChat" class="btn-fechar-chat">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                    </svg>
                </button>
            </div>
            
            <div class="milly-chat-body" id="millyChatBody">
                <div class="milly-message-bubble milly-message">
                    <div class="message-avatar">
                        <img src="Milly_semfundo.png" alt="Milly">
                    </div>
                    <div class="message-content">
                        <p>Ol√°! üëã Eu sou a Milly, sua assistente virtual!</p>
                        <p>Estou aqui para te ajudar com:</p>
                        <ul>
                            <li>üìù Cadastrar credenciais e senhas do totem</li>
                            <li>üìä Exportar dados para Excel</li>
                            <li>üìß Enviar relat√≥rios por email</li>
                            <li>‚ùì Tirar d√∫vidas sobre o sistema</li>
                        </ul>
                        <p>Como posso te ajudar hoje?</p>
                    </div>
                </div>
            </div>
            
            <div class="milly-chat-input-container">
                <div class="milly-chat-suggestions" id="millyChatSuggestions">
                    <button class="suggestion-btn" data-action="cadastrar">Cadastrar credenciais</button>
                    <button class="suggestion-btn" data-action="totem">Cadastrar senha do totem</button>
                    <button class="suggestion-btn" data-action="exportar">Exportar Excel</button>
                    <button class="suggestion-btn" data-action="email">Enviar por email</button>
                    <button class="suggestion-btn" data-action="ajuda">Preciso de ajuda</button>
                </div>
                <div class="milly-chat-input-wrapper">
                    <textarea id="millyChatInput" class="milly-chat-input" placeholder="Digite sua mensagem... (Shift+Enter para nova linha)" autocomplete="off" rows="1"></textarea>
                    <button id="btnEnviarMillyChat" class="btn-enviar-chat">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-logo-container">
                <img src="logo-intelite.png" alt="Intelite" class="footer-logo">
            </div>
            <div class="footer-text">
                <p>&copy; 2025 - Desenvolvido por <strong>Deyvison Chaves</strong></p>
            </div>
        </div>
    </footer>


    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="script.js"></script>
</body>
</html> 